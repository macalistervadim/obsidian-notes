Оч классный и полезный паттерн, который избавляет от множества головных болей. Он действует в связке с паттерном репозиторий ([[Архитектура. Паттерн "Репозиторий"]]) и позволяет нам не беспокоится об сохранности наших данных. Он по сути выступает неким еще одним слоем абстракции между внешним апи сервисом (условно flask) и нашими сервисами - тоесть теперь сервисы не открывают сессию, не создают репозиторий - а используют через контекстный менеджер uow, который упрощает код в разы а также улучшает его безопасность

Для разъяснения:
- Репозиторий отвечает за сокрытие деталей хранения данных (будь то Sql или NoSQL или dict итд)
- А UnitOfWork отвечает за атомарность операций по работе с репозиторием (с базой данных, которую репозиторий использует). Тоесть либо вся операция проходит, либо она откатывается

>[!info]
>Атомарность в данном случае подразумевает факт того, что вся наша транзакция должна выполниться успешно. Либо вся транзакция успешна - либо она откатывается и наш UOW обрабатывает эти ошибки

Паттерн UnitOfWork должен иметь два основных метода - commit() и rollback() соответственно. Но также чаще всего его используют в контекстном менеджере - поэтому также следует ему объявить `__enter__` и `__exit__`.

OUW избавляет от необходимости вечно прокидывать в код сессию, репозиторий и другие детали, а также не заставляет нас следить за rollback(), commit() итд - все происходит в самом контекстном менеджере (разве что мы вручную вызываем commit() из нашего uow), отсюда мы соблюдаем DRY и также позволяем себе замокать UOW в тестах какими-то фиктивными данными для быстрых юнит-тестов

![[Снимок экрана 2025-06-05 в 19.31.09.png]]

[[Архитектура]] [[IT]]
